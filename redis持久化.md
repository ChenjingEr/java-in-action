## redis 持久化
redis不仅仅作为内存数据库，还支持持久化数据。这样再一次重启redis服务器则会加载持久化文件中的数据。Redis提供了2中持久化方式。

#####RDB

RDB方式是通过将在在内存中的数据生成一份快照持久化到磁盘上生成RDB文件(RDB中记录的是内存保存的数据)。<br>
RDB方式是配置一个或几个检查点，只要到了这几个检查点的任何一个，就执行持久化。<br>
在redis.config中通过save来设置检查点,且可以设置多个检查点。
```
save 900 1   //在900秒之内，对数据库至少有1次修改(增加，删除，修改)
save 300 10  //在300秒之内，对数据库至少有10次修改(增加，删除，修改)
save 60 10000 //在60秒之内，对数据库至少10000次修改(增加，删除，修改)
```

在客户端执行 save / bgsave命令也会持久化。save阻塞所有的客户端请求，bgsave是通过异步执行的<br>
执行flushall命令也会执行持久化

* RDB执行过程：
    - redis 使用fork函数复制一份当前进程的副本
    - 父进程继续处理客户端请求，子进程(副本)将内存中的数据写入硬盘的临时文件
    - 子进程完成数据写入，替换旧的RDB文件

#####AOF

AOF方式是通过将命令追加到AOF文件中来实现的持久化(AOP文件中记录的是执行过的命令)<br>
AOF默认关闭,通过配置开启：
```
appendonly yes  //默认是no
```